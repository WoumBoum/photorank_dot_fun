<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Theme Test</title>
    <link rel="stylesheet" href="/static/css/style.css">
</head>
<body>
    <div class="container">
        <header>
            <h1>Theme Test</h1>
            <nav>
                <button class="theme-toggle" id="theme-toggle" title="Toggle dark mode">◐</button>
            </nav>
        </header>
        <p>Test paragraph to see theme changes</p>
    </div>

    <script>
        console.log('Theme test script loaded');
        
        function initThemeToggle() {
            console.log('initThemeToggle called');
            const themeToggle = document.getElementById('theme-toggle');
            if (!themeToggle) {
                console.error('Theme toggle button not found');
                return;
            }

            console.log('Theme toggle found:', themeToggle);

            // Load saved theme or use system preference
            const savedTheme = localStorage.getItem('theme');
            const prefersDark = window.matchMedia('(prefers-color-scheme: dark)').matches;
            const currentTheme = savedTheme || (prefersDark ? 'dark' : 'light');
            
            console.log('Current theme:', currentTheme);
            document.documentElement.setAttribute('data-theme', currentTheme);
            updateToggleButton(currentTheme);

            themeToggle.addEventListener('click', () => {
                console.log('Theme toggle clicked');
                const currentTheme = document.documentElement.getAttribute('data-theme');
                const newTheme = currentTheme === 'dark' ? 'light' : 'dark';
                
                console.log('Switching from', currentTheme, 'to', newTheme);
                document.documentElement.setAttribute('data-theme', newTheme);
                localStorage.setItem('theme', newTheme);
                updateToggleButton(newTheme);
            });
        }

        function updateToggleButton(theme) {
            const themeToggle = document.getElementById('theme-toggle');
            if (!themeToggle) return;
            
            themeToggle.textContent = theme === 'dark' ? '◐' : '◑';
            themeToggle.title = theme === 'dark' ? 'Switch to light mode' : 'Switch to dark mode';
            console.log('Button updated to:', themeToggle.textContent);
        }

        document.addEventListener('DOMContentLoaded', () => {
            console.log('DOM loaded');
            initThemeToggle();
        });
    </script>
</body>
</html>